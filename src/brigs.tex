\subsection{Анализ проблем}

В своей статье Бриггс описывает модифицированный алгоритм раскраски графа, он называет его \textbf{optimistic coloring}.
Разберем какие именно проблемы скрываются в выше описанных примерах, и как можно их решить.

В примере, представленном на рисунке~\ref{fig:ex2}, как было отмечено ранее, алгоритм Чайтина производит выгрузку хотя бы одной переменной.
Однако выгрузку можно избежать.
Эта проблема связана с тем, что по умолчанию алгоритм считает, что если в графе есть вершина со степенью большей $N$,
то такой граф нельзя раскрасить в $N$ цветов.

В примере с SVD разложением проблема возникает не когда алгоритм выбирает сгрузить переменные $i$ и $n$, а когда
после выгрузки $N$ и $M$ он не обнаруживает что переменные $n$ и $i$ могут поместиться на регистры.

\subsection{Идея}

Для решения вышеперечисленных проблем Бриггс предлагает внести следующие корректировки в алгоритм Чайтина:

\begin{enumerate}
    \item В пункте~\ref{chatin_algo_spill} алгоритма при обнаружении вершины с количеством соседей большим или равным $N$,
    вместо немедленной выгрузки, разместим ее на стек. \label{briggs_change_spill}

    \item Соответственно в пункте \ref{chatin_algo_color_assignment} возникает проблема, ведь теперь не всегда
    вершину можно будет покрасить. В этом случае оставим их не покрашенными, это те переменные которые нужно
    выгрузить.
    
\end{enumerate}

Эти изменения помогут решить найденные проблемы алгоритма Чайтина. Первая проблема решается в пункте \ref{briggs_change_spill}.
Теперь в примере, представленном на рисунке~\ref{fig:ex2}, хотя некоторая вершина и будет выбрана для выгрузки, во время этапа \ref{chatin_algo_color_assignment}
всем вершинам удастся получить цвет.

Вторая проблема также решена. Теперь хотя переменные $i, n, M, N$ будут выгружены (можно считать что в таком
порядке), при попытке подобрать цвета для $M, N$ станет понятно что подобрать для них цвета не получится.
Поэтому переменные $i, n$ не придется выгружать.

Эвристика предыдущего алгоритма скорее отвечала на
вопрос ``имеет ли вершина $< N$ соседей?'', чем на вопрос ``можно ли подобрать цвет для этой вершины?''. Новый
алгоритм дает ответ на последний вопрос.
